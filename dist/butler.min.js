/*
 * butler.js - v0.0.1
 *
 * Butler is your I/O javascript voice driven major-domo
 * 
 * MIT license
 * 2015-07-30T08:09:42.619Z
 */


(function(e){"use strict";var t=this,n=t.SpeechRecognition||t.webkitSpeechRecognition||t.mozSpeechRecognition||t.msSpeechRecognition||t.oSpeechRecognition;if(!n)return t.annyang=null,e;var o,i,s=[],r={start:[],error:[],end:[],result:[],resultMatch:[],resultNoMatch:[],errorNetwork:[],errorPermissionBlocked:[],errorPermissionDenied:[]},l=0,a=!1,c="font-weight: bold; color: #00f;",d=!1,h=/\s*\((.*?)\)\s*/g,f=/(\(\?:[^)]+\))\?/g,u=/(\(\?)?:\w+/g,m=/\*\w+/g,p=/[\-{}\[\]+?.,\\\^$|#]/g,g=function(e){return e=e.replace(p,"\\$&").replace(h,"(?:$1)?").replace(u,function(e,t){return t?e:"([^\\s]+)"}).replace(m,"(.*?)").replace(f,"\\s*$1?\\s*"),new RegExp("^"+e+"$","i")},y=function(e){e.forEach(function(e){e.callback.apply(e.context)})},v=function(){w()||t.annyang.init({},!1)},w=function(){return o!==e};t.annyang={init:function(h,f){f=f===e?!0:!!f,o&&o.abort&&o.abort(),o=new n,o.maxAlternatives=5,o.continuous="http:"===t.location.protocol,o.lang="en-US",o.onstart=function(){y(r.start)},o.onerror=function(e){switch(y(r.error),e.error){case"network":y(r.errorNetwork);break;case"not-allowed":case"service-not-allowed":i=!1,y((new Date).getTime()-l<200?r.errorPermissionBlocked:r.errorPermissionDenied)}},o.onend=function(){if(y(r.end),i){var e=(new Date).getTime()-l;1e3>e?setTimeout(t.annyang.start,1e3-e):t.annyang.start()}},o.onresult=function(e){if(d)return a&&t.console.log("Speech heard, but annyang is paused"),!1;y(r.result);for(var n,o=e.results[e.resultIndex],i=0;i<o.length;i++){n=o[i].transcript.trim(),a&&t.console.log("Speech recognized: %c"+n,c);for(var l=0,h=s.length;h>l;l++){var f=s[l].command.exec(n);if(f){var u=f.slice(1);return a&&(t.console.log("command matched: %c"+s[l].originalPhrase,c),u.length&&t.console.log("with parameters",u)),s[l].callback.apply(this,u),y(r.resultMatch),!0}}}return y(r.resultNoMatch),!1},f&&(s=[]),h.length&&this.addCommands(h)},start:function(n){d=!1,v(),n=n||{},i=n.autoRestart!==e?!!n.autoRestart:!0,n.continuous!==e&&(o.continuous=!!n.continuous),l=(new Date).getTime();try{o.start()}catch(e){a&&t.console.log(e.message)}},abort:function(){i=!1,w&&o.abort()},pause:function(){d=!0},resume:function(){t.annyang.start()},debug:function(e){a=arguments.length>0?!!e:!0},setLanguage:function(e){v(),o.lang=e},addCommands:function(e){var n,o;v();for(var i in e)if(e.hasOwnProperty(i)){if(n=t[e[i]]||e[i],"function"!=typeof n)continue;o=g(i),s.push({command:o,callback:n,originalPhrase:i})}a&&t.console.log("Commands successfully loaded: %c"+s.length,c)},removeCommands:function(t){return t===e?void(s=[]):(t=Array.isArray(t)?t:[t],void(s=s.filter(function(e){for(var n=0;n<t.length;n++)if(t[n]===e.originalPhrase)return!1;return!0})))},addCallback:function(n,o,i){if(r[n]!==e){var s=t[o]||o;"function"==typeof s&&r[n].push({callback:s,context:i||this})}}}}).call(this),Element.prototype.isVisible=function(){"use strict";function e(o,i,s,r,l,a,c){var d=o.parentNode,h=2;return n(o)?9===d.nodeType?!0:"0"===t(o,"opacity")||"none"===t(o,"display")||"hidden"===t(o,"visibility")?!1:(("undefined"==typeof i||"undefined"==typeof s||"undefined"==typeof r||"undefined"==typeof l||"undefined"==typeof a||"undefined"==typeof c)&&(i=o.offsetTop,l=o.offsetLeft,r=i+o.offsetHeight,s=l+o.offsetWidth,a=o.offsetWidth,c=o.offsetHeight),d?"hidden"!==t(d,"overflow")&&"scroll"!==t(d,"overflow")||!(l+h>d.offsetWidth+d.scrollLeft||l+a-h<d.scrollLeft||i+h>d.offsetHeight+d.scrollTop||i+c-h<d.scrollTop)?(o.offsetParent===d&&(l+=d.offsetLeft,i+=d.offsetTop),e(d,i,s,r,l,a,c)):!1:!0):!1}function t(e,t){return window.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle?e.currentStyle[t]:void 0}function n(e){for(;e=e.parentNode;)if(e==document)return!0;return!1}return e(this)},window.smoothScroll=function(){if(void 0!==document.querySelectorAll&&void 0!==window.pageYOffset&&void 0!==history.pushState){var e=function(e){return"HTML"===e.nodeName?-window.pageYOffset:e.getBoundingClientRect().top+window.pageYOffset},t=function(e){return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},n=function(e,n,o,i){return o>i?n:e+(n-e)*t(o/i)},o=function(t,o,i){o=o||500;var s=window.pageYOffset;if("number"==typeof t)var r=parseInt(t);else var r=e(t);var l=Date.now(),a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,15)},c=function(){var e=Date.now()-l;window.scroll(0,n(s,r,e,o)),e>o?"function"==typeof i&&i(t):a(c)};c()},i=function(e){e.preventDefault(),location.hash!==this.hash&&window.history.pushState(null,null,this.hash),o(document.getElementById(this.hash.substring(1)),500,function(e){location.replace("#"+e.id)})};return document.addEventListener("DOMContentLoaded",function(){for(var e,t=document.querySelectorAll('a[href^="#"]:not([href="#"])'),n=t.length;e=t[--n];)e.addEventListener("click",i,!1)}),o}}(),function(e){"use strict";var t=function(t){var n=[],o=0;if(this.position=0,this.dom=e.document.body.getElementsByTagName("*"),this.element=this.dom[this.position],this.scroll=!1,this.scrollDuration=500,this.classAliasList=[],this.identifierClassArray=[],t&&(t.scroll&&(this.scroll=!0),t.scrollDuration&&(this.scrollDuration=Number(t.scrollDuration)),t.viewable)){for(o;o<=this.dom.length;o+=1)this.dom[o]&&this.dom[o].isVisible()&&n.push(this.dom[o]);this.dom=n}};t.prototype.scroller=function(t){this.scroll&&e.smoothScroll(t,this.scrollDuration)},t.prototype.underline=function(){this.scroller(this.element,500),this.element&&this.element.style&&(this.element.style.transition="outline 0.55s linear",this.element.style.outline="3px inset #08FD31",this.element.style.outlineOffset="-2px")},t.prototype.erase=function(){this.element&&this.element.style&&(this.element.style.transition="outline none",this.element.style.outline="none")},t.prototype.select=function(e){this.position=0,this.element=this.dom[this.position],this.next(e)},t.prototype.arrayCompared=function(e,t){return e.filter(function(e){return t.indexOf(e)>-1})},t.prototype.next=function(t){var n=this.position;if(t)if(-1!==t.indexOf("#"))for(n;n<=this.dom.length;n+=1){if(this.dom[n]&&this.dom[n].id&&this.dom[n].id.toString()===t.replace("#","")){this.element=this.dom[n],this.position=n+1;break}if(n>=this.dom.length){this.position=0,e.console.info("No next elements, restarting from the first element in page");break}}else if(-1!==t.indexOf("."))for(this.identifierClassArray=t.toString().replace(".","").split(" "),n;n<=this.dom.length;n+=1){if(this.dom[n]&&this.dom[n].classList&&-1!==t.indexOf(".")&&(this.classAliasList=this.dom[n].classList.toString().split(" "),this.arrayCompared(this.classAliasList,this.identifierClassArray).length>0)){this.element=this.dom[n],this.position=n+1;break}if(n>=this.dom.length){this.position=0,e.console.info("No next elements, restarting from the first element in page");break}}else if(t.indexOf("<")>-1)for(n;n<=this.dom.length;n+=1){if(this.dom[n]&&this.dom[n].tagName&&this.dom[n].tagName.toString().toLowerCase()===t.replace("<","").replace(">","")){this.element=this.dom[n],this.position=n+1;break}if(n>=this.dom.length){this.position=0,e.console.info("No next elements, restarting from the first element in page");break}}else e.console.error("Please set a correct #id or .class or <tag> identifier");else this.position+=1,this.position>this.dom.length&&(this.position=0,this.element=this.dom[this.position],e.console.info("No next elements, restarting from the first element in page")),this.element=this.dom[this.position]},t.prototype.previous=function(t){var n=this.position;if(t)if(-1!==t.indexOf("#"))for(n<=this.position;n>=0;n-=1){if(this.dom[n]&&this.dom[n].id&&this.dom[n].id.toString()===t.replace("#","")){this.element=this.dom[n],this.position=n-1;break}if(n<this.dom.length){this.position=0,e.console.info("No previous elements, restarting from the first element in page");break}}else if(t.indexOf(".")>-1)for(this.identifierClassArray=t.toString().replace(".","").split(" "),n<=this.position;n>=0;n-=1){if(this.dom[n]&&this.dom[n].classList&&-1!==t.indexOf(".")&&(this.classAliasList=this.dom[n].classList.toString().split(" "),this.arrayCompared(this.classAliasList,this.identifierClassArray).length>0)){this.element=this.dom[n],this.position=n-1;break}if(n<this.dom.length){this.position=0,e.console.info("No previous elements, restarting from the first element in page");break}}else if(t.indexOf("<")>-1)for(n<=this.position;n>=0;n-=1){if(this.dom[n]&&this.dom[n].tagName&&this.dom[n].tagName.toString().toLowerCase()===t.replace("<","").replace(">","")){this.element=this.dom[n],this.position=n-1;break}if(n<this.dom.length){this.position=0,e.console.info("No previous elements, restarting from the first element in page");break}}else e.console.error("You must set a correct #id or .class or <tag> parameter");else this.position-=1,this.position<0&&(this.position=0,e.console.info("No previous elements, restarting from the first element in page")),this.element=this.dom[this.position]},t.prototype.skipNext=function(t){Number(t)>0&&(this.position+=t),Number(t)>this.dom.length&&(this.position=0,this.element=this.dom[this.position],e.console.log("No next elements, restarting from the first DOM element"))},t.prototype.skipPrev=function(t){Number(t)>0&&(this.position-=t),this.position<0&&(this.position=0,this.element=this.dom[this.position],e.console.log("No previous elements, restarting from the first DOM element"))},e.Highlighter=t}(window),window.document.ready=new Promise(function(e){function t(){e(),document.removeEventListener("DOMContentLoaded",t,!0),window.removeEventListener("load",t,!0)}"complete"===window.document.readyState?e():(document.addEventListener("DOMContentLoaded",t,!0),window.addEventListener("load",t,!0))}),function(e,t){"use strict";var n=function(){var n=new e.Highlighter({scroll:!1}),o=new e.CustomEvent("Butler:start"),i=new e.CustomEvent("Butler:end"),s=new e.CustomEvent("Butler:detection"),r=new e.CustomEvent("Butler:detection-match"),l=new e.CustomEvent("Butler:detection-not-match"),a=new e.CustomEvent("Butler:error");this.lang="en-EN",this.commands={"selector on":function(){n.erase(),n.underline()},"selector off":function(t){n.erase(),n=new e.Highlighter,e.console.info("Deselect all elements",t)},"selector next":function(t){n.erase(),n.next(),n.underline(),e.console.info("Select next element",t)},"selector back":function(t){n.erase(),n.previous(),n.underline(),e.console.info("Select next element",t)},"selector next id *detect":function(t){n.erase(),n.next("#"+t),n.underline(),e.console.info("Select next element by id",t)},"selector next tag *detect":function(t){n.erase(),n.next("<"+t.replace("<","").replace(">","")+">"),n.underline(),e.console.info("Select next element by id",t)},"selector next class *detect":function(t){n.erase(),n.next("."+t.replace(".","")),n.underline(),e.console.info("Select next element by class",t)},"selector back id *detect":function(t){n.erase(),n.next("#"+t),n.underline(),e.console.info("Select next element by id",t)},"selector back tag *detect":function(t){n.erase(),n.next("<"+t.replace("<","").replace(">","")+">"),n.underline(),e.console.info("Select next element by id",t)},"selector back class *detect":function(t){n.erase(),n.next("."+t.replace(".","")),n.underline(),e.console.info("Select next element by class",t)},"selector add class *detection":function(t){try{n.element.classList.add(t)}catch(t){e.alert(t)}},"selector add id *detection":function(t){try{n.element.id=t}catch(t){e.alert(t)}},"selector put value *detection":function(t){try{n.element.value=t}catch(t){e.alert(t)}},"selector insert text *detection":function(t){try{n.element.innerText=t}catch(t){e.alert(t)}},"selector remove class *detection":function(t){try{n.element.classElement.remove(t)}catch(t){e.alert(t)}},"selector empty text":function(){try{n.element.innerText=""}catch(t){e.alert(t)}},"trigger click":function(){try{n.element.click()}catch(t){e.alert(t)}},"trigger focus":function(){try{n.element.focus()}catch(t){e.alert(t)}},"selector hover":function(){try{n.element.onmouseover()}catch(t){e.alert(t)}},"selector which":function(){e.alert("nodename: "+n.element.nodeName.toLowerCase()+"\nclasses: "+n.element.classList.toString()+"\nid:"+n.element.id)}},t.addCallback("start",function(t){o.eventData=t,e.dispatchEvent(o)}),t.addCallback("error",function(t){a.eventData=t,e.dispatchEvent(a)}),t.addCallback("end",function(t){i.eventData=t,e.dispatchEvent(i)}),t.addCallback("result",function(t){s.eventData=t,e.dispatchEvent(s)}),t.addCallback("resultMatch",function(t){r.eventData=t,e.dispatchEvent(r)}),t.addCallback("resultNotMatch",function(t){l.eventData=t,e.dispatchEvent(l)}),t.setLanguage(this.lang),t.addCommands(this.commands,!1)};n.prototype.start=function(e){e&&e.debug&&t.debug(e.debug),t.start({autoRestart:!1,continuous:!0})},n.prototype.plug=function(e){e&&e.commands&&t.addCommands(e.commands)},e.document.ready.then(function(){e.Butler=new n})}(window,annyang);
//# sourceMappingURL=butler.min.js.map